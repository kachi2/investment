/*! Investorm v1.1.0 | Copyright by Softnio. */
!function(f,h){"use strict";let a=h(document),r=h("#ajax-modal"),u=f.Form,g="undefined",v="Something wrong in form or may invalid data.";function e(t,e){let d=!!e&&h(e);a.on("click",t,function(t){let e=h(this),a=e.parents("form");var o=a.attr("action"),s=a.data("confirm"),n=a.serialize(),i=1200;a.valid()&&(s&&typeof msgs[s]!=g&&msgs[s]?f.Ask(msgs[s].title,msgs[s].context,msgs[s].btn,msgs[s].custom,msgs[s].type).then(function(t){t&&u.toPost(o,n,{btn:e,timeout:i,after:function(t){!0!==t.reload&&setTimeout(function(){"hide"==t.modal&&a.parents(".modal").modal("hide")},i),t.embed&&0<d.length&&d.html(t.embed).addClass("embed-updated")}})}):u.toPost(o,n,{btn:e,timeout:i,after:function(t){!0!==t.reload&&setTimeout(function(){"hide"==t.modal&&a.parents(".modal").modal("hide")},i),t.embed&&0<d.length&&d.html(t.embed).addClass("embed-updated")}})),t.preventDefault()})}function o(t){a.on("click",t,function(t){let e=h(this),a=typeof routes!=g&&routes,o={},s={};var n=e.data("action"),i=e.data("uid"),d=e.data("view"),l=e.data("backdrop"),c=e.data("method");a[n]?("plan"!=n&&"profit"!=n&&(o.view=d||!1),i&&(o.uid=i),c&&(o.method=c),s.modal=r,s.backdrop=l||!0,r.modal("dispose"),u.toModal(a[n],o,s)):f.Toast(v,"error",{ui:"is-dark"}),t.preventDefault()})}function s(t,e){let c=!!e&&h(e);a.on("click",t,function(t){let e=h(this);var a,o,n=e.data("uid"),i=e.data("action"),s=!!e.data("reload"),d=typeof quick_update!=g&&quick_update,l={uid:n,action:i,reload:s};d&&n&&typeof qmsg!=g?(a=qmsg.action[i]||qmsg.context,o="password"==i?"danger":"",s="password"==i?"error":"info",f.Ask(qmsg.title,a,qmsg.btn,o,s).then(function(t){t&&u.toPost(d,l,{after:function(s){if("suspend"==i||"active"==i){let t="success",e="danger",a="suspend",o="active";"active"==i&&(t="danger",e="success",a="active",o="suspend"),h(".u-sw-"+a+"-"+n).addClass("d-none"),h(".u-sw-"+o+"-"+n).removeClass("d-none"),h(".u-status-"+n).text(s.state).removeClass("text-"+t).addClass("text-"+e)}s.embed&&0<c.length&&c.html(s.embed).addClass("embed-updated")}})})):f.Toast(v,"error",{ui:"is-dark"}),t.preventDefault()})}function n(t,e){let a=h(t),o=e||"click";function m(t,e,a){u.toPost(t,e,a)}a.on(o,function(t){let s=h(this),n=typeof routes!=g&&routes;var i=s.data("action"),d=s.data("uid"),l=s.data("slug"),c=!!s.data("redirect"),r=!!s.data("reload"),u=!!s.data("confirm");if(n[i]){let e=n[i],a=!!s.is("button")&&{btn:s},o={uid:d||null,slug:l||null,reload:r,redirect:c};"payment"!=i&&"withdraw"!=i||(o={slug:l,type:i,status:s.is(":checked")?"active":"inactive",reload:r,redirect:c}),"cancelled"==i&&(o={uid:d||null,reload:r}),"payout"==i&&(o={reload:r}),u&&typeof msgs!=g&&msgs[i]?f.Ask(msgs[i].title,msgs[i].context,msgs[i].btn,msgs[i].custom,msgs[i].type).then(function(t){t&&m(e,o,a)}):m(e,o,a)}else f.Toast(v,"error",{ui:"is-dark"});t.preventDefault()})}function i(t,i){a.on("click",t,function(t){t.preventDefault();let a=h(this),e=a.data("method"),o={btn:a};if(a.attr("disabled",!0),"modal"==i){let t=a.parents(".modal"),e=t.find(".close");o.target=t,o.close=e,e.addClass("disabled")}var s=typeof bulkpq.url!=g&&bulkpq.url,n=typeof bulkpq.total!=g?bulkpq.total:0,t=typeof bulkpq.queues!=g&&bulkpq.queues;s&&t&&!function a(o,t,s,n){let i=h(s.btn),d=t.action||!1,l=typeof s.target!=g&&h(s.target),c=typeof s.close!=g&&h(s.close);f.Form.toPost(o,t,{btn:i,onSuccess:function(t){var e;"success"==t.status&&1==t.next&&(e={batchs:n[t.idx],idx:t.idx,done:t.done,total:t.total},d&&(e.action=d),setTimeout(function(){a(o,e,s,n)},200)),t.done&&l&&l.find(".pup-count").text(t.done),100<=t.progress?(t.message&&f.Toast(t.message,"success"),l&&l.find(".pup-status").width("100%").removeClass("progress-bar-animated"),i&&i.removeAttr("disabled"),setTimeout(function(){c&&c.removeClass("disabled"),l&&l.modal("hide"),window.location.reload()},1200)):l&&l.find(".pup-status").width(t.progress+"%")}})}(s,{batchs:t[0],action:e,total:n},o,t)})}function d(t,e,a){let o=h(t),s=h(e).is(":checked"),n=h(a).val();""!=n&&"0"!=n&&s?o.removeClass("disabled").prop("disabled",!1):o.addClass("disabled").prop("disabled",!0)}a.ready(function(){function p(t,e){u.toPost(t,e,{onSuccess:function(t){var e,a,o,s=t.embed&&t.orderid||"modal"==t.hide?350:50;"modal"==t.hide&&r.modal("hide"),!0===t.status&&(r.html(""),t.modal&&(r.html(t.modal),r.modal("dispose"),r.modal({backdrop:"static",show:!0})),t.embed&&t.orderid&&(h("#order-id-"+t.orderid).html(t.embed).addClass("order-updated"),r.modal("hide"))),t.msg&&(e=t.type||"success",t.reload&&!0!==t.reload&&t.reload,a=t.title&&t.msg?"<h5>"+t.title+"</h5><p>"+t.msg+"</p>":t.msg,o=t.position||"bottom-right",a&&setTimeout(function(){f.Toast(a,e,{position:o})},s))}})}var t;!function(){let t=h(".send-email"),o=h(".u-send-mail"),s=h("#send-email-user");t.on("click",function(t){let e=h(this);var a=e.data("uid");a&&0<s.length&&(s.modal("show"),s.find("#userid").val(a),s.find("form")[0].reset(),u.button(o,!0)),t.preventDefault()}),o.on("click",function(t){let e=h(this),a=e.parents("form"),o=e.parents(".modal");a.valid()&&(u.button(e,!1,!0),u.toSubmit(a,{btn:e,hide:o})),t.preventDefault()})}(),function(){let t=h(".bulk-apply"),n=h("#bulk-action"),i=h(".qs-checkbox-i");t.on("click",function(){let t=n.val(),e=typeof bulk_update!=g&&bulk_update,a,o,s=[];""!=t&&"0"!=t&&e&&typeof qmsg!=g?(i.each(function(t,e){h(e).is(":checked")&&s.push(h(this).data("uid"))}),a={users:s,action:t},o=typeof qmsg.action[t]!=g&&qmsg.action[t]?qmsg.action[t]:qmsg.action.bulk,f.Ask(qmsg.title,o,qmsg.bulkbtn,"","info").then(function(t){t&&u.toPost(e,a)})):f.Toast(v,"error",{ui:"is-dark"})})}(),function(){let t=".qs-checkbox",e=h(t),a=h(t+"-i"),o=h(".bulk-apply"),s=h("#bulk-action");e.on("click",function(){d(o,a,s),a.prop("checked",this.checked)}),a.on("click",function(){d(o,a,s)}),s.on("change",function(){d(o,a,s)})}(),function(){let t=h(".submit-settings");t.on("click",function(t){let e=h(this),a=e.parents("form");var o=a.attr("action"),s=a.serialize();o&&s&&u.toPost(o,s,{btn:e}),t.preventDefault()})}(),function(){let i=".validate-slug",t=h(i),d=null;t.on("input",function(){let t=h(this),e=typeof routes!=g&&routes,a=t.val(),o=t.data("uid"),s=t.parent("div").find(i+"-loader"),n=t.parent("div").find(i+"-error");d&&clearTimeout(d),s.removeClass("hide"),n.addClass("hide"),e.validate?d=setTimeout(function(){u.toPost(e.validate,{slug:a,id:o},{onSuccess:function(t){s.addClass("hide"),n.removeClass("hide"),t.note&&n.attr("data-original-title",t.note),t.error?n.removeClass("ni-check").addClass("ni-alert"):n.removeClass("ni-alert").addClass("ni-check")}})},300):f.Toast(v,"error",{ui:"is-dark"})})}(),function(){let t=h(".send-test-mail");t.on("click",function(t){let e=h(this),a,o,s,n={};e.data("slug")?(o=typeof mail_sent_url!=g&&mail_sent_url,s={slug:e.data("slug")}):(a=e.parents("form"),o=a.attr("action"),s=a.serialize(),n={btn:e}),o&&s?u.toPost(o,s,n):f.Toast(v,"error",{ui:"is-dark"}),t.preventDefault()})}(),function(){let t=h(".form-settings");f.Toggle.switchValue(".switch-option",{target:".switch-option-value"}),t.each(function(){u.states(h(this))}),h(document).on("click",".back-me",function(t){t.preventDefault(),window.history.back()})}(),function(){let o="supported-cur",s=h("#currency-based"),n=h("#currency-alter"),t=h("."+o+"-cb");s.add(n).on("change",function(){var t=h(this).val().toLowerCase();h("#"+o+"-"+t).prop("checked",!0)}),t.on("change",function(){var t,e,a;this.checked||(t=h(this).attr("id").replace(o+"-",""),e=s.val().toLowerCase(),a=n.val().toLowerCase(),t!==e&&t!==a||h(this).prop("checked",!0))});let e="exchange-method",a=h("#"+e),i=h("#"+e+"-manual"),d=h("#"+e+"-auto");a.on("change",function(){"manual"==a.val()?(i.css("display","block"),d.css("display","none")):(i.css("display","none"),d.css("display","block"))})}(),t=".m-tnx-update",a.on("click",t,function(t){let o=h(this),s=!!o.is("button")&&o.parents("form"),e=typeof routes!=g&&routes,n=!!o.data("reload"),i=!!o.data("confirm");var d,l,c,r=!!o.data("state")&&o.data("state"),u=(0<s.length?s:o).data("action"),m=0<s.length?s.attr("action"):e[u];if(m&&u&&r){let t=o.data("uid"),e=o.data("tnx"),a;a=0<s.length?(a=s.serialize(),a+"&method="+u+"&reload="+n):{uid:t,orderid:e,status:r,method:u,reload:n},i&&typeof msgs!=g&&typeof msgs[r]!=g&&msgs[r]?(d=msgs[r].title,l=msgs[r].context,c=msgs[r].btn,u=msgs[r].custom,r=msgs[r].type,f.Ask(d,l,c,u,r).then(function(t){t&&p(m,a)})):p(m,a)}else f.Toast(v,"error",{ui:"is-dark"});t.preventDefault()}),o(".m-tnx-detail"),o(".m-tnx-manual"),n(".admin-action"),n(".dwm-quick-action","change"),n(".system-opt"),s(".quick-action"),e(".m-tnx-create"),e("#user-add"),i(".m-ivs-sync","modal"),o(".m-ivs-process"),o(".m-ivs-scheme"),e(".m-ivs-save","#scheme-list-container"),s(".m-ivs-update","#scheme-list-container"),e(".m-ivs-approve"),e(".m-ivs-cancel-plan"),n(".m-ivs-cancel"),n(".m-ivs-payout")})}(NioApp,jQuery);